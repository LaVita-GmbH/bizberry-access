scopes:
  services:
    - key: pegasus
      resources:
        - key: users
          actions:
            - key: request_transaction_token
              internal: true
            - key: impersonate
              critical: true
              selectors:
                - key: others
            - key: impersionation
              internal: true
              selectors:
                - key: restricted
            - key: create
            - key: read
              selectors:
                - key: own
                - key: any
            - key: write
              critical: true
              selectors:
                - key: own
                - key: any

        - key: tenants
          actions:
            - key: create
            - key: read
            - key: write

    - key: elysium
      resources:
        - key: clients
          actions:
            - key: create
              selectors:
                - key: norel
                - key: own
                - key: any
            - key: read
              selectors:
                - key: norelact
                - key: own
                - key: any
            - key: write
              selectors:
                - key: norelact
                - key: own
                - key: any
            - key: delete
              selectors:
                - key: any
        - key: addresses
          actions:
            - key: create
              selectors:
                - key: norelact
                - key: own
                - key: any
            - key: read
              selectors:
                - key: norelact
                - key: own
                - key: any
            - key: write
              selectors:
                - key: norelact
                - key: own
                - key: any
            - key: delete
              selectors:
                - key: norelact
                - key: own
                - key: any

roles:
  - key: default
    is_default: true
    scopes:
      - code: pegasus.users.read.own
      - code: pegasus.users.write.own
      - code: pegasus.tenants.read
      - code: elysium.clients.create.own
      - code: elysium.addresses.create.own
      - code: elysium.addresses.read.own
      - code: elysium.addresses.write.own
      - code: elysium.addresses.delete.own

  - key: admin
    scopes:
      - code: pegasus.users.read.any
      - code: pegasus.users.write.any
      - code: pegasus.tenants.create
      - code: pegasus.tenants.write
      - code: elysium.clients.create.any
      - code: elysium.clients.read.any
      - code: elysium.clients.write.any
      - code: elysium.clients.delete.any
      - code: elysium.addresses.create.any
      - code: elysium.addresses.read.any
      - code: elysium.addresses.write.any
      - code: elysium.addresses.delete.any
    included_roles:
      - key: default

  - key: consumer
    scopes:
      - code: pegasus.tenants.read
      - code: elysium.clients.create.norel
      - code: elysium.clients.read.norelact
      - code: elysium.clients.write.norelact
      - code: elysium.addresses.create.norelact
      - code: elysium.addresses.read.norelact
      - code: elysium.addresses.write.norelact
      - code: elysium.addresses.delete.norelact
