scopes:
  services:
    - key: pegasus
      resources:
        - key: users
          actions:
            - key: request_transaction_token
              internal: true
            - key: impersonate
              critical: true
              selectors:
                - key: others
            - key: impersionation
              internal: true
              selectors:
                - key: restricted
            - key: create
            - key: read
              selectors:
                - key: own
                - key: any
            - key: edit
              critical: true
              selectors:
                - key: own
                - key: any

        - key: tenants
          actions:
            - key: create
            - key: read
            - key: edit

    - key: elysium
      resources:
        - key: clients
          actions:
            - key: create
              selectors:
                - key: any
            - key: read
              selectors:
                - key: norelact
                - key: own
                - key: any
            - key: edit
              selectors:
                - key: norelact
                - key: own
                - key: any
            - key: delete
              selectors:
                - key: any
        - key: addresses
          actions:
            - key: create
              selectors:
                - key: norelact
                - key: own
                - key: any
            - key: read
              selectors:
                - key: norelact
                - key: own
                - key: any
            - key: edit
              selectors:
                - key: norelact
                - key: own
                - key: any
            - key: delete
              selectors:
                - key: norelact
                - key: own
                - key: any

    - key: nektar
      resources:
        - key: categories
          actions:
            - key: create
            - key: read
              selectors:
                - key: any
            - key: write
              selectors:
                - key: any
            - key: delete
              selectors:
                - key: any
        - key: products
          actions:
            - key: create
            - key: read
              selectors:
                - key: any
                - key: active
                - key: terminated
            - key: write
              selectors:
                - key: any
            - key: delete
              selectors:
                - key: any

roles:
  - key: default
    is_default: true
    scopes:
      - code: pegasus.users.read.own
      - code: pegasus.users.edit.own
      - code: pegasus.tenants.read
      - code: elysium.clients.read.own
      - code: elysium.clients.edit.own
      - code: elysium.addresses.create.own
      - code: elysium.addresses.read.own
      - code: elysium.addresses.edit.own
      - code: elysium.addresses.delete.own
      - code: nektar.products.read.active
      - code: nektar.products.read.terminated

  - key: admin
    scopes:
      - code: pegasus.users.create
      - code: pegasus.users.read.any
      - code: pegasus.users.edit.any
      - code: pegasus.tenants.create
      - code: pegasus.tenants.edit
      - code: elysium.clients.create.any
      - code: elysium.clients.read.any
      - code: elysium.clients.edit.any
      - code: elysium.clients.delete.any
      - code: elysium.addresses.create.any
      - code: elysium.addresses.read.any
      - code: elysium.addresses.edit.any
      - code: elysium.addresses.delete.any
      - code: nektar.products.create
      - code: nektar.products.read.any
      - code: nektar.products.write.any
      - code: nektar.products.delete.any
      - code: nektar.categories.create
      - code: nektar.categories.read.any
      - code: nektar.categories.write.any
      - code: nektar.categories.delete.any
    included_roles:
      - key: default

  - key: consumer
    scopes:
      - code: pegasus.tenants.read
      - code: elysium.addresses.create.norelact
      - code: elysium.addresses.read.norelact
      - code: elysium.addresses.edit.norelact
      - code: elysium.addresses.delete.norelact
      - code: nektar.products.read.active
